# ç‰¹å¾æå–ä¸åŒ¹é…ä¼˜åŒ–æŒ‡å—

## æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£æ˜¯ DDC è®¾å¤‡æ¸…å•åŒ¹é…æŠ¥ä»·ç³»ç»Ÿçš„æ ¸å¿ƒæŠ€æœ¯æŒ‡å—ï¼Œä¸“æ³¨äºç‰¹å¾æå–å’ŒåŒ¹é…ç®—æ³•çš„é…ç½®ã€è°ƒè¯•å’Œä¼˜åŒ–ã€‚

**ç›®æ ‡è¯»è€…**: ç³»ç»Ÿç»´æŠ¤äººå‘˜ã€AI åŠ©æ‰‹ï¼ˆKiroï¼‰ã€æŠ€æœ¯æ”¯æŒäººå‘˜

**ä½¿ç”¨åœºæ™¯**:
- ğŸ”§ è°ƒæ•´ç‰¹å¾æå–è§„åˆ™
- ğŸ¯ ä¼˜åŒ–åŒ¹é…ç®—æ³•å‚æ•°
- ğŸ› è¯Šæ–­åŒ¹é…é—®é¢˜
- ğŸ“Š åˆ†æåŒ¹é…æ•ˆæœ
- ğŸš€ æå‡åŒ¹é…å‡†ç¡®ç‡

**ç›¸å…³æ–‡æ¡£**:
- [MAINTENANCE.md](../MAINTENANCE.md) - ç³»ç»Ÿç»´æŠ¤æŒ‡å—
- [MATCHING_OPTIMIZATION_SUMMARY.md](../MATCHING_OPTIMIZATION_SUMMARY.md) - åŒ¹é…ä¼˜åŒ–æ€»ç»“
- [é…ç½®æ–‡ä»¶](../data/static_config.json) - ç³»ç»Ÿé…ç½®

---

## ç›®å½•

1. [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
2. [ç‰¹å¾æå–ç³»ç»Ÿ](#ç‰¹å¾æå–ç³»ç»Ÿ)
3. [åŒ¹é…ç®—æ³•](#åŒ¹é…ç®—æ³•)
4. [é…ç½®æ–‡ä»¶è¯¦è§£](#é…ç½®æ–‡ä»¶è¯¦è§£)
5. [è°ƒè¯•å·¥å…·](#è°ƒè¯•å·¥å…·)
6. [ä¼˜åŒ–ç­–ç•¥](#ä¼˜åŒ–ç­–ç•¥)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
8. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## æ ¸å¿ƒæ¦‚å¿µ

### ç³»ç»Ÿå·¥ä½œæµç¨‹

```
Excel è®¾å¤‡æè¿°
    â†“
æ–‡æœ¬é¢„å¤„ç† (TextPreprocessor)
    â†“
ç‰¹å¾æå– (extract_features)
    â†“
ç‰¹å¾å½’ä¸€åŒ– (normalize_text)
    â†“
ç‰¹å¾åŒ¹é… (MatchEngine)
    â†“
åŠ æƒè¯„åˆ† (calculate_score)
    â†“
é˜ˆå€¼è¿‡æ»¤ (match_threshold)
    â†“
åŒ¹é…ç»“æœ
```

### å…³é”®ç»„ä»¶

| ç»„ä»¶ | æ–‡ä»¶è·¯å¾„ | èŒè´£ |
|------|---------|------|
| TextPreprocessor | `backend/modules/text_preprocessor.py` | æ–‡æœ¬é¢„å¤„ç†å’Œç‰¹å¾æå– |
| RuleGenerator | `backend/modules/rule_generator.py` | è§„åˆ™ç”Ÿæˆå’Œç‰¹å¾æƒé‡åˆ†é… |
| MatchEngine | `backend/modules/match_engine.py` | åŒ¹é…ç®—æ³•å’Œè¯„åˆ†è®¡ç®— |
| é…ç½®æ–‡ä»¶ | `data/static_config.json` | å½’ä¸€åŒ–è§„åˆ™å’Œå…¨å±€é…ç½® |



---

## ç‰¹å¾æå–ç³»ç»Ÿ

### ç‰¹å¾æå–æµç¨‹

ç‰¹å¾æå–æ˜¯åŒ¹é…ç³»ç»Ÿçš„ç¬¬ä¸€æ­¥ï¼Œå†³å®šäº†åç»­åŒ¹é…çš„è´¨é‡ã€‚

#### 1. æ•°æ®æº

è®¾å¤‡ä¿¡æ¯åŒ…å«ä»¥ä¸‹å­—æ®µï¼š
- **brand** (å“ç‰Œ): å¦‚"éœå°¼éŸ¦å°”"ã€"è¥¿é—¨å­"
- **device_name** (è®¾å¤‡åç§°): å¦‚"åº§é˜€"ã€"æ¸©åº¦ä¼ æ„Ÿå™¨"
- **spec_model** (è§„æ ¼å‹å·): å¦‚"äºŒé€š+DN15+æ°´+V5011N1040/U+V5011ç³»åˆ—"
- **detailed_params** (è¯¦ç»†å‚æ•°): å¦‚"å‹å·ï¼šV5011N1040/U\n é€šå¾„ï¼š1/2"(DN15)\n é˜€ä½“ç±»å‹ï¼šäºŒé€šåº§é˜€"

#### 2. æå–ç­–ç•¥

**ç­–ç•¥ 1: å“ç‰Œå’Œè®¾å¤‡åç§°ç›´æ¥ä½¿ç”¨**
```python
# å“ç‰Œç›´æ¥å½’ä¸€åŒ–ï¼Œä¸æ‹†åˆ†
if device.brand:
    normalized_brand = self.preprocessor.normalize_text(device.brand)
    features.append(normalized_brand)

# è®¾å¤‡åç§°ç›´æ¥å½’ä¸€åŒ–ï¼Œä¸æ‹†åˆ†
if device.device_name:
    normalized_name = self.preprocessor.normalize_text(device.device_name)
    features.append(normalized_name)
```

**ç­–ç•¥ 2: è§„æ ¼å‹å·ä½¿ç”¨"+"æ‹†åˆ†**
```python
# è§„æ ¼å‹å·: "äºŒé€š+DN15+æ°´+V5011N1040/U+V5011ç³»åˆ—"
# æ‹†åˆ†ä¸º: ["äºŒé€š", "dn15", "æ°´", "v5011n1040/u", "v5011ç³»åˆ—"]
if device.spec_model:
    spec_parts = device.spec_model.split('+')
    for part in spec_parts:
        normalized_part = self.preprocessor.normalize_text(part)
        if normalized_part and len(normalized_part) >= min_length:
            features.append(normalized_part)
```

**ç­–ç•¥ 3: è¯¦ç»†å‚æ•°ç»“æ„åŒ–è§£æ**
```python
# è¯¦ç»†å‚æ•°: "å‹å·ï¼šV5011N1040/U\n é€šå¾„ï¼š1/2"(DN15)\n é˜€ä½“ç±»å‹ï¼šäºŒé€šåº§é˜€"
# å¤„ç†æ­¥éª¤:
# 1. æŒ‰è¡Œæ‹†åˆ†
# 2. è¯†åˆ«é”®å€¼å¯¹æ ¼å¼ (é”®ï¼šå€¼)
# 3. åªæå–å€¼éƒ¨åˆ†ï¼Œå¿½ç•¥é”®ï¼ˆå­—æ®µåï¼‰
# 4. å¤„ç†æ‹¬å·å†…å®¹ï¼Œåˆ†åˆ«æå–
```

#### 3. ç‰¹å¾è¿‡æ»¤

**è¿‡æ»¤è§„åˆ™**:
1. **å…ƒæ•°æ®å…³é”®è¯**: è¿‡æ»¤å­—æ®µåç§°ï¼ˆå‹å·ã€é€šå¾„ã€é˜€ä½“ç±»å‹ç­‰ï¼‰
2. **æ— æ„ä¹‰å•å­—ç¬¦**: è¿‡æ»¤ uã€nã€1 ç­‰å•å­—ç¬¦ï¼ˆä¿ç•™ä¸­æ–‡å•å­—å’Œæœ‰æ„ä¹‰çš„å•ä½ç¬¦å·ï¼‰
3. **æœ€å°é•¿åº¦**: ä¸­æ–‡å­—ç¬¦æœ€å°é•¿åº¦1ï¼Œå…¶ä»–å­—ç¬¦æœ€å°é•¿åº¦2
4. **æ‹¬å·å¤„ç†**: "1/2"(DN15)" æå–ä¸º "1/2"" å’Œ "dn15" ä¸¤ä¸ªç‹¬ç«‹ç‰¹å¾



### å½’ä¸€åŒ–è§„åˆ™

å½’ä¸€åŒ–ç¡®ä¿ä¸åŒè¡¨è¾¾æ–¹å¼çš„æ–‡æœ¬èƒ½å¤ŸåŒ¹é…ã€‚

#### ä¸‰å±‚å½’ä¸€åŒ–

**å±‚æ¬¡ 1: ç²¾å‡†æ˜ å°„** (normalization_map)
```json
{
  "~": "-",
  "ï½": "-",
  "â„ƒ": "",
  "Â°C": "",
  "VDC": "V",
  "PPM": "ppm",
  "DN": "dn"
}
```

**å±‚æ¬¡ 2: é€šç”¨å½’ä¸€åŒ–**
- å…¨è§’è½¬åŠè§’: "ï¼‘ï¼’ï¼“" â†’ "123"
- åˆ é™¤ç©ºæ ¼: "4 - 20 mA" â†’ "4-20mA"
- ç»Ÿä¸€å°å†™: "PPM" â†’ "ppm"

**å±‚æ¬¡ 3: æ¨¡ç³Šå…¼å®¹** (åŒ¹é…é˜¶æ®µ)
- ç”±åŒ¹é…å¼•æ“å¤„ç†ç›¸ä¼¼åº¦è®¡ç®—

#### å…³é”®é…ç½®é¡¹

**feature_split_chars** (ç‰¹å¾æ‹†åˆ†ç¬¦å·)
```json
{
  "feature_split_chars": ["+", ";", "ï¼›", "ã€", "|", "\\", "\n"]
}
```

**é‡è¦**: 
- "+" æ˜¯æ•°æ®åˆ†éš”ç¬¦ï¼Œç”¨äºæ‹†åˆ†
- ","ã€"ï¼Œ"ã€"/" ä¸æ˜¯åˆ†éš”ç¬¦ï¼Œä¿ç•™åœ¨æ•°æ®ä¸­

**ignore_keywords** (è¿‡æ»¤å…³é”®è¯)
```json
{
  "ignore_keywords": [
    "æ–½å·¥è¦æ±‚", "éªŒæ”¶", "å›¾çº¸", "è§„èŒƒ", "æ¸…å•",
    "è°ƒè¯•", "å®‰è£…", "å«ç¨", "ä¸å«ç¨", "å¤‡æ³¨"
  ]
}
```

### ç‰¹å¾æå–ç¤ºä¾‹

**è¾“å…¥è®¾å¤‡**:
```json
{
  "device_id": "V5011N1040_U000000000000000001",
  "brand": "éœå°¼éŸ¦å°”",
  "device_name": "åº§é˜€",
  "spec_model": "äºŒé€š+DN15+æ°´+V5011N1040/U+V5011ç³»åˆ—",
  "detailed_params": "å‹å·ï¼šV5011N1040/U\n é€šå¾„ï¼š1/2\"(DN15)\n é˜€ä½“ç±»å‹ï¼šäºŒé€šåº§é˜€ \n é€‚ç”¨ä»‹è´¨ï¼šæ°´"
}
```

**æå–çš„ç‰¹å¾**:
```python
[
  "éœå°¼éŸ¦å°”",      # å“ç‰Œ
  "åº§é˜€",          # è®¾å¤‡åç§°
  "äºŒé€š",          # è§„æ ¼å‹å·æ‹†åˆ†
  "dn15",          # è§„æ ¼å‹å·æ‹†åˆ†ï¼ˆå½’ä¸€åŒ–ï¼‰
  "æ°´",            # è§„æ ¼å‹å·æ‹†åˆ†
  "v5011n1040/u",  # è§„æ ¼å‹å·æ‹†åˆ†ï¼ˆå½’ä¸€åŒ–ï¼Œä¿ç•™"/"ï¼‰
  "v5011ç³»åˆ—",     # è§„æ ¼å‹å·æ‹†åˆ†ï¼ˆå½’ä¸€åŒ–ï¼‰
  "1/2\"",         # è¯¦ç»†å‚æ•°æ‹¬å·å¤–ï¼ˆä¿ç•™"/"ï¼‰
  "äºŒé€šåº§é˜€"       # è¯¦ç»†å‚æ•°å€¼ï¼ˆè¿‡æ»¤äº†"é˜€ä½“ç±»å‹ï¼š"ï¼‰
]
```

**ç‰¹å¾æƒé‡**:
```python
{
  "éœå°¼éŸ¦å°”": 3.0,      # å“ç‰Œ
  "åº§é˜€": 1.0,          # è®¾å¤‡åç§°
  "äºŒé€š": 1.0,          # é€šç”¨å‚æ•°
  "dn15": 3.0,          # å‹å·
  "æ°´": 1.0,            # é€šç”¨å‚æ•°
  "v5011n1040/u": 3.0,  # å‹å·
  "v5011ç³»åˆ—": 1.0,     # é€šç”¨å‚æ•°
  "1/2\"": 1.0,         # é€šç”¨å‚æ•°
  "äºŒé€šåº§é˜€": 1.0       # é€šç”¨å‚æ•°
}
```



---

## åŒ¹é…ç®—æ³•

### åŒ¹é…æµç¨‹

```
Excel æè¿°æ–‡æœ¬
    â†“
é¢„å¤„ç† (preprocess)
    â†“
æå–ç‰¹å¾ (extract_features)
    â†“
éå†æ‰€æœ‰è§„åˆ™
    â†“
è®¡ç®—åŒ¹é…å¾—åˆ† (calculate_score)
    â†“
è¿‡æ»¤ä½äºé˜ˆå€¼çš„ç»“æœ
    â†“
æŒ‰å¾—åˆ†æ’åº
    â†“
è¿”å›æœ€ä½³åŒ¹é…
```

### è¯„åˆ†ç®—æ³•

**åŸºæœ¬å…¬å¼**:
```
æ€»åˆ† = Î£ (ç‰¹å¾æƒé‡ Ã— åŒ¹é…ç³»æ•°)

å…¶ä¸­:
- ç‰¹å¾æƒé‡: ç”±è§„åˆ™å®šä¹‰ (1.0-5.0)
- åŒ¹é…ç³»æ•°: 1.0 (å®Œå…¨åŒ¹é…) æˆ– 0.0 (ä¸åŒ¹é…)
```

**ç¤ºä¾‹è®¡ç®—**:
```python
# Excel æè¿°: "éœå°¼éŸ¦å°” äºŒé€šåº§é˜€ DN15"
# æå–ç‰¹å¾: ["éœå°¼éŸ¦å°”", "äºŒé€šåº§é˜€", "dn15"]

# è§„åˆ™ç‰¹å¾å’Œæƒé‡:
rule_features = {
    "éœå°¼éŸ¦å°”": 3.0,
    "åº§é˜€": 1.0,
    "äºŒé€š": 1.0,
    "dn15": 3.0,
    "æ°´": 1.0,
    "v5011n1040/u": 3.0
}

# åŒ¹é…è®¡ç®—:
# "éœå°¼éŸ¦å°”" åŒ¹é… â†’ 3.0 åˆ†
# "äºŒé€šåº§é˜€" åŒ…å« "åº§é˜€" â†’ 1.0 åˆ†
# "äºŒé€šåº§é˜€" åŒ…å« "äºŒé€š" â†’ 1.0 åˆ†
# "dn15" åŒ¹é… â†’ 3.0 åˆ†
# æ€»åˆ† = 3.0 + 1.0 + 1.0 + 3.0 = 8.0 åˆ†

# é˜ˆå€¼æ£€æŸ¥:
if score >= match_threshold:  # å‡è®¾é˜ˆå€¼ä¸º 5.0
    return True  # åŒ¹é…æˆåŠŸ
```

### æƒé‡åˆ†é…ç­–ç•¥

**å½“å‰ç­–ç•¥** (ä¼˜åŒ–å):

| ç‰¹å¾ç±»å‹ | æƒé‡ | è¯´æ˜ |
|---------|------|------|
| å“ç‰Œ | 3.0 | å“ç‰ŒåŒ¹é…å¾ˆé‡è¦ |
| å‹å· | 3.0 | å‹å·æ˜¯å…³é”®æ ‡è¯† |
| è®¾å¤‡ç±»å‹å…³é”®è¯ | 5.0 | æœ€é«˜æƒé‡ï¼Œå†³å®šè®¾å¤‡å¤§ç±» |
| å…¶ä»–å‚æ•° | 1.0 | é€šç”¨å‚æ•°ï¼Œè¾…åŠ©åˆ¤æ–­ |

**æƒé‡åˆ†é…ä»£ç **:
```python
def assign_weights(self, features: List[str]) -> Dict[str, float]:
    weights = {}
    
    for feature in features:
        # æ£€æŸ¥æ˜¯å¦æ˜¯å“ç‰Œ
        if any(brand in feature for brand in self.brand_keywords):
            weights[feature] = 3.0
        # æ£€æŸ¥æ˜¯å¦æ˜¯å‹å·
        elif self._is_model_number(feature):
            weights[feature] = 3.0
        # æ£€æŸ¥æ˜¯å¦æ˜¯è®¾å¤‡ç±»å‹å…³é”®è¯
        elif any(keyword in feature for keyword in self.device_type_keywords):
            weights[feature] = 5.0
        # å…¶ä»–å‚æ•°
        else:
            weights[feature] = 1.0
    
    return weights
```

### é˜ˆå€¼è®¾ç½®

**é»˜è®¤é˜ˆå€¼**: 5.0 (åœ¨ `global_config.default_match_threshold`)

**é˜ˆå€¼å½±å“**:
- **é˜ˆå€¼è¿‡ä½** (< 3.0): å®¹æ˜“è¯¯åŒ¹é…ï¼Œå‡†ç¡®ç‡ä¸‹é™
- **é˜ˆå€¼é€‚ä¸­** (5.0-7.0): å¹³è¡¡å‡†ç¡®ç‡å’Œå¬å›ç‡ï¼ˆæ¨èï¼‰
- **é˜ˆå€¼è¿‡é«˜** (> 10.0): åŒ¹é…è¿‡äºä¸¥æ ¼ï¼Œå¾ˆå¤šè®¾å¤‡åŒ¹é…å¤±è´¥

**è°ƒæ•´å»ºè®®**:
```json
{
  "global_config": {
    "default_match_threshold": 5.0  // æ¨èå€¼
  }
}
```



---

## é…ç½®æ–‡ä»¶è¯¦è§£

### é…ç½®æ–‡ä»¶ä½ç½®

`data/static_config.json`

### å®Œæ•´é…ç½®ç»“æ„

```json
{
  "normalization_map": { ... },      // å½’ä¸€åŒ–æ˜ å°„è¡¨
  "feature_split_chars": [ ... ],    // ç‰¹å¾æ‹†åˆ†ç¬¦å·
  "ignore_keywords": [ ... ],        // è¿‡æ»¤å…³é”®è¯
  "global_config": { ... },          // å…¨å±€é…ç½®
  "ui_config": { ... },              // UIé…ç½®
  "performance_config": { ... },     // æ€§èƒ½é…ç½®
  "device_row_recognition": { ... }  // è®¾å¤‡è¡Œè¯†åˆ«é…ç½®
}
```

### normalization_map (å½’ä¸€åŒ–æ˜ å°„è¡¨)

**ä½œç”¨**: ç»Ÿä¸€ä¸åŒçš„è¡¨è¾¾æ–¹å¼

**é…ç½®ç¤ºä¾‹**:
```json
{
  "normalization_map": {
    "~": "-",
    "ï½": "-",
    "â€”": "-",
    " ": "",
    "â„ƒ": "",
    "Â°C": "",
    "åº¦": "",
    "åˆ°": "-",
    "è‡³": "-",
    "VDC": "V",
    "Vdc": "V",
    "VAC": "V",
    "Vac": "V",
    "mA DC": "mA",
    "mADC": "mA",
    "PPM": "ppm",
    "ppm": "ppm",
    "%RH": "%rh",
    "RH": "%rh",
    "DN": "dn",
    "PN": "pn"
  }
}
```

**æ·»åŠ æ–°æ˜ å°„**:
```json
{
  "normalization_map": {
    "ç±³/ç§’": "m/s",
    "å…¬æ–¤": "kg",
    "åƒå…‹": "kg",
    "æ¯«ç±³": "mm"
  }
}
```

**æ³¨æ„äº‹é¡¹**:
- æ˜ å°„æŒ‰é”®çš„é•¿åº¦ä»é•¿åˆ°çŸ­æ’åºï¼Œä¼˜å…ˆåŒ¹é…è¾ƒé•¿çš„å­—ç¬¦ä¸²
- é¿å…å¾ªç¯æ˜ å°„ï¼ˆAâ†’B, Bâ†’Aï¼‰
- ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºåˆ é™¤è¯¥å­—ç¬¦

### feature_split_chars (ç‰¹å¾æ‹†åˆ†ç¬¦å·)

**ä½œç”¨**: å®šä¹‰å“ªäº›ç¬¦å·ç”¨äºæ‹†åˆ†ç‰¹å¾

**å½“å‰é…ç½®**:
```json
{
  "feature_split_chars": ["+", ";", "ï¼›", "ã€", "|", "\\", "\n"]
}
```

**é‡è¦è§„åˆ™**:
- "+" æ˜¯ä¸»è¦çš„æ•°æ®åˆ†éš”ç¬¦
- ","ã€"ï¼Œ"ã€"/" ä¸æ˜¯åˆ†éš”ç¬¦ï¼Œä¿ç•™åœ¨æ•°æ®ä¸­
- "\n" ç”¨äºæ‹†åˆ†è¯¦ç»†å‚æ•°çš„å¤šè¡Œæ–‡æœ¬

**ä¿®æ”¹å»ºè®®**:
- æ·»åŠ æ–°åˆ†éš”ç¬¦æ—¶è¦è°¨æ…ï¼Œå¯èƒ½å½±å“ç°æœ‰æ•°æ®
- æµ‹è¯•æ–°åˆ†éš”ç¬¦å¯¹ç‰¹å¾æå–çš„å½±å“
- ä¿®æ”¹åéœ€è¦é‡æ–°ç”Ÿæˆæ‰€æœ‰è§„åˆ™

### ignore_keywords (è¿‡æ»¤å…³é”®è¯)

**ä½œç”¨**: ä»è®¾å¤‡æè¿°ä¸­åˆ é™¤æ— å…³å…³é”®è¯

**å½“å‰é…ç½®**:
```json
{
  "ignore_keywords": [
    "æ–½å·¥è¦æ±‚", "éªŒæ”¶", "å›¾çº¸", "è§„èŒƒ", "æ¸…å•",
    "è°ƒè¯•", "å®‰è£…", "å«ç¨", "ä¸å«ç¨", "å¤‡æ³¨",
    "è¯´æ˜", "è¦æ±‚", "æ ‡å‡†", "å›½æ ‡", "è¿›å£",
    "å›½äº§", "å“ç‰Œ", "å‚å®¶", "ä¾›è´§", "äº¤è´§", "è´¨ä¿"
  ]
}
```

**æ·»åŠ æ–°å…³é”®è¯**:
```json
{
  "ignore_keywords": [
    "æ–½å·¥è¦æ±‚",
    "éªŒæ”¶",
    "åŒ…é‚®",      // æ–°å¢
    "ä¿ƒé”€",      // æ–°å¢
    "ç‰¹ä»·"       // æ–°å¢
  ]
}
```

### global_config (å…¨å±€é…ç½®)

**ä½œç”¨**: æ§åˆ¶ç³»ç»Ÿè¡Œä¸ºçš„å…¨å±€å‚æ•°

**å½“å‰é…ç½®**:
```json
{
  "global_config": {
    "default_match_threshold": 5.0,    // é»˜è®¤åŒ¹é…é˜ˆå€¼
    "unify_lowercase": true,           // ç»Ÿä¸€å°å†™
    "remove_whitespace": true,         // åˆ é™¤ç©ºæ ¼
    "fullwidth_to_halfwidth": true     // å…¨è§’è½¬åŠè§’
  }
}
```

**å‚æ•°è¯´æ˜**:

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| default_match_threshold | number | 5.0 | é»˜è®¤åŒ¹é…é˜ˆå€¼ï¼Œå»ºè®® 5.0-7.0 |
| unify_lowercase | boolean | true | æ˜¯å¦ç»Ÿä¸€è½¬æ¢ä¸ºå°å†™ |
| remove_whitespace | boolean | true | æ˜¯å¦åˆ é™¤æ‰€æœ‰ç©ºæ ¼ |
| fullwidth_to_halfwidth | boolean | true | æ˜¯å¦å°†å…¨è§’å­—ç¬¦è½¬æ¢ä¸ºåŠè§’ |

**è°ƒæ•´å»ºè®®**:
```json
{
  "global_config": {
    "default_match_threshold": 7.0,  // æé«˜é˜ˆå€¼ï¼Œæ›´ä¸¥æ ¼åŒ¹é…
    "unify_lowercase": true,         // ä¿æŒå¼€å¯
    "remove_whitespace": true,       // ä¿æŒå¼€å¯
    "fullwidth_to_halfwidth": true   // ä¿æŒå¼€å¯
  }
}
```



---

## è°ƒè¯•å·¥å…·

### å·¥å…·æ¸…å•

| å·¥å…· | æ–‡ä»¶è·¯å¾„ | ç”¨é€” |
|------|---------|------|
| ç‰¹å¾æå–è°ƒè¯• | `backend/debug_feature_extraction.py` | æŸ¥çœ‹è®¾å¤‡çš„ç‰¹å¾æå–è¿‡ç¨‹ |
| è§„åˆ™éªŒè¯ | `backend/verify_rules.py` | éªŒè¯ç”Ÿæˆçš„è§„åˆ™æ˜¯å¦æ­£ç¡® |
| æ•°æ®æ£€æŸ¥ | `backend/check_db_data.py` | æ£€æŸ¥æ•°æ®åº“ä¸­çš„è®¾å¤‡æ•°æ® |
| åŒ¹é…è¯Šæ–­ | `backend/diagnose_matching_issue.py` | è¯Šæ–­åŒ¹é…é—®é¢˜ |

### 1. ç‰¹å¾æå–è°ƒè¯•

**å·¥å…·**: `backend/debug_feature_extraction.py`

**ç”¨é€”**: æŸ¥çœ‹è®¾å¤‡çš„è¯¦ç»†ç‰¹å¾æå–è¿‡ç¨‹

**ä½¿ç”¨æ–¹æ³•**:
```bash
python backend/debug_feature_extraction.py
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
è®¾å¤‡ä¿¡æ¯
================================================================================
è®¾å¤‡ID: V5011N1040_U000000000000000001
å“ç‰Œ: éœå°¼éŸ¦å°”
è®¾å¤‡åç§°: åº§é˜€
è§„æ ¼å‹å·: äºŒé€š+DN15+æ°´+V5011N1040/U+V5011ç³»åˆ—
è¯¦ç»†å‚æ•°: 'å‹å·ï¼šV5011N1040/U\\n é€šå¾„ï¼š1/2"(DN15)\\n é˜€ä½“ç±»å‹ï¼šäºŒé€šåº§é˜€ \\n é€‚ç”¨ä»‹è´¨ï¼šæ°´'

================================================================================
ç‰¹å¾æå–è¿‡ç¨‹
================================================================================

æå–çš„ç‰¹å¾ (å…±9ä¸ª):
  1. éœå°¼éŸ¦å°”
  2. åº§é˜€
  3. äºŒé€š
  4. dn15
  5. æ°´
  6. v5011n1040/u
  7. v5011ç³»åˆ—
  8. 1/2"
  9. äºŒé€šåº§é˜€
```

**ä¿®æ”¹è°ƒè¯•ç›®æ ‡**:
```python
# ä¿®æ”¹ debug_feature_extraction.py ä¸­çš„æŸ¥è¯¢æ¡ä»¶
device = session.query(Device).filter(Device.device_id.like('SENSOR001%')).first()
```

### 2. è§„åˆ™éªŒè¯

**å·¥å…·**: `backend/verify_rules.py`

**ç”¨é€”**: éªŒè¯ç”Ÿæˆçš„è§„åˆ™æ˜¯å¦æ­£ç¡®

**ä½¿ç”¨æ–¹æ³•**:
```bash
python backend/verify_rules.py
```

**è¾“å‡ºç¤ºä¾‹**:
```
è§„åˆ™ID: R_V5011N1040_U000000000000000001
ç›®æ ‡è®¾å¤‡: V5011N1040_U000000000000000001

æå–çš„ç‰¹å¾ (å…±9ä¸ª):
  1. éœå°¼éŸ¦å°”
  2. åº§é˜€
  3. äºŒé€š
  4. dn15
  5. æ°´
  6. v5011n1040/u
  7. v5011ç³»åˆ—
  8. 1/2"
  9. äºŒé€šåº§é˜€

ç‰¹å¾æƒé‡ (å…±9ä¸ª):
  éœå°¼éŸ¦å°”: 3.0
  åº§é˜€: 1.0
  äºŒé€š: 1.0
  dn15: 3.0
  æ°´: 1.0
  v5011n1040/u: 3.0
  v5011ç³»åˆ—: 1.0
  1/2": 1.0
  äºŒé€šåº§é˜€: 1.0

ç‰¹å¾æ£€æŸ¥:
æœŸæœ›ç‰¹å¾æ•°: 9
å®é™…ç‰¹å¾æ•°: 9
âœ“ ç‰¹å¾æ•°é‡æ­£ç¡®
```

### 3. æ•°æ®æ£€æŸ¥

**å·¥å…·**: `backend/check_db_data.py`

**ç”¨é€”**: æ£€æŸ¥æ•°æ®åº“ä¸­çš„è®¾å¤‡æ•°æ®æ ¼å¼

**ä½¿ç”¨æ–¹æ³•**:
```bash
python backend/check_db_data.py
```

### 4. åŒ¹é…è¯Šæ–­

**å·¥å…·**: `backend/diagnose_matching_issue.py`

**ç”¨é€”**: è¯Šæ–­åŒ¹é…é—®é¢˜ï¼Œåˆ†æä¸ºä»€ä¹ˆåŒ¹é…å¤±è´¥æˆ–åŒ¹é…é”™è¯¯

**ä½¿ç”¨æ–¹æ³•**:
```bash
python backend/diagnose_matching_issue.py
```

**åŠŸèƒ½**:
- æµ‹è¯•ä¸åŒè®¾å¤‡æè¿°çš„åŒ¹é…ç»“æœ
- åˆ†æåŒ¹é…å¾—åˆ†
- ç»Ÿè®¡æƒé‡å’Œé˜ˆå€¼åˆ†å¸ƒ
- æä¾›ä¼˜åŒ–å»ºè®®



---

## ä¼˜åŒ–ç­–ç•¥

### ä¼˜åŒ–å·¥ä½œæµç¨‹

```
1. å‘ç°é—®é¢˜
   â†“
2. è¯Šæ–­åˆ†æ
   â†“
3. åˆ¶å®šæ–¹æ¡ˆ
   â†“
4. å®æ–½è°ƒæ•´
   â†“
5. æµ‹è¯•éªŒè¯
   â†“
6. éƒ¨ç½²ä¸Šçº¿
```

### ç­–ç•¥ 1: åŸºäºé—®é¢˜è¯Šæ–­çš„ä¼˜åŒ–

**æ­¥éª¤ 1: æ”¶é›†é—®é¢˜æ¡ˆä¾‹**
```bash
# è®°å½•åŒ¹é…å¤±è´¥æˆ–é”™è¯¯çš„æ¡ˆä¾‹
echo "æ¸©åº¦ä¼ æ„Ÿå™¨ï¼Œ0-50â„ƒï¼Œ4-20mA â†’ é”™è¯¯åŒ¹é…åˆ°å‹åŠ›ä¼ æ„Ÿå™¨" >> issues.txt
```

**æ­¥éª¤ 2: è¿è¡Œè¯Šæ–­å·¥å…·**
```bash
python backend/diagnose_matching_issue.py
```

**æ­¥éª¤ 3: åˆ†æè¯Šæ–­ç»“æœ**
- æŸ¥çœ‹ç‰¹å¾æå–æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹æƒé‡åˆ†é…æ˜¯å¦åˆç†
- æŸ¥çœ‹é˜ˆå€¼è®¾ç½®æ˜¯å¦é€‚å½“
- æŸ¥çœ‹å½’ä¸€åŒ–è§„åˆ™æ˜¯å¦æœ‰é—®é¢˜

**æ­¥éª¤ 4: åˆ¶å®šä¼˜åŒ–æ–¹æ¡ˆ**
- ä¿®æ”¹å½’ä¸€åŒ–è§„åˆ™
- è°ƒæ•´ç‰¹å¾æƒé‡
- è°ƒæ•´åŒ¹é…é˜ˆå€¼
- æ·»åŠ æˆ–åˆ é™¤ç‰¹å¾

**æ­¥éª¤ 5: å®æ–½ä¼˜åŒ–**
```bash
# 1. ä¿®æ”¹é…ç½®æ–‡ä»¶
vim data/static_config.json

# 2. é‡æ–°ç”Ÿæˆè§„åˆ™
python backend/generate_rules_for_devices.py --all

# 3. éªŒè¯è§„åˆ™
python backend/verify_rules.py

# 4. æµ‹è¯•åŒ¹é…
python backend/test_match_debug.py
```

### ç­–ç•¥ 2: åŸºäºæ•°æ®åˆ†æçš„ä¼˜åŒ–

**æ­¥éª¤ 1: æ”¶é›†åŒ¹é…æ—¥å¿—**
```python
# å¯ç”¨åŒ¹é…æ—¥å¿—è®°å½•
# åœ¨ backend/app.py ä¸­æ·»åŠ æ—¥å¿—è®°å½•
logger.info(f"åŒ¹é…ç»“æœ: {description} â†’ {matched_device}")
```

**æ­¥éª¤ 2: åˆ†æé«˜é¢‘è¯¯åŒ¹é…**
```bash
# ç»Ÿè®¡è¯¯åŒ¹é…æ¨¡å¼
grep "é”™è¯¯åŒ¹é…" logs/app.log | sort | uniq -c | sort -rn
```

**æ­¥éª¤ 3: è¯†åˆ«é—®é¢˜ç‰¹å¾**
- å“ªäº›ç‰¹å¾å¯¼è‡´è¯¯åŒ¹é…ï¼Ÿ
- å“ªäº›ç‰¹å¾æƒé‡è¿‡é«˜ï¼Ÿ
- å“ªäº›ç‰¹å¾æƒé‡è¿‡ä½ï¼Ÿ

**æ­¥éª¤ 4: æ‰¹é‡è°ƒæ•´**
```bash
# ä½¿ç”¨æ‰¹é‡æ“ä½œè°ƒæ•´æƒé‡
curl -X POST "http://localhost:5000/api/rules/management/batch-update" \
  -H "Content-Type: application/json" \
  -d '{
    "operation": "update_weights_by_type",
    "feature_type": "parameter",
    "new_weight": 1.0,
    "rule_ids": []
  }'
```

### ç­–ç•¥ 3: æ¸è¿›å¼ä¼˜åŒ–

**åŸåˆ™**: å°æ­¥å¿«è·‘ï¼Œé€æ­¥ä¼˜åŒ–

**æ­¥éª¤ 1: å•ä¸ªè§„åˆ™ä¼˜åŒ–**
```bash
# 1. é€‰æ‹©ä¸€ä¸ªé—®é¢˜è§„åˆ™
# 2. è°ƒæ•´è¯¥è§„åˆ™çš„æƒé‡å’Œé˜ˆå€¼
# 3. æµ‹è¯•éªŒè¯æ•ˆæœ
# 4. å¦‚æœæ•ˆæœå¥½ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªè§„åˆ™
```

**æ­¥éª¤ 2: æ‰¹é‡åº”ç”¨**
```bash
# å°†æˆåŠŸçš„ä¼˜åŒ–æ–¹æ¡ˆåº”ç”¨åˆ°ç›¸ä¼¼è§„åˆ™
# ä¾‹å¦‚ï¼šæ‰€æœ‰ä¼ æ„Ÿå™¨ç±»è®¾å¤‡ä½¿ç”¨ç›¸åŒçš„æƒé‡ç­–ç•¥
```

**æ­¥éª¤ 3: å…¨å±€ä¼˜åŒ–**
```bash
# ä¿®æ”¹å…¨å±€é…ç½®ï¼Œå½±å“æ‰€æœ‰è§„åˆ™
# ä¾‹å¦‚ï¼šæé«˜é»˜è®¤é˜ˆå€¼
```

### ç­–ç•¥ 4: A/B æµ‹è¯•

**æ­¥éª¤ 1: å‡†å¤‡æµ‹è¯•æ•°æ®é›†**
```json
{
  "test_cases": [
    {
      "description": "æ¸©åº¦ä¼ æ„Ÿå™¨ï¼Œ0-50â„ƒï¼Œ4-20mA",
      "expected_device_id": "SENSOR001"
    },
    {
      "description": "å‹åŠ›ä¼ æ„Ÿå™¨ï¼Œ0-10barï¼Œ4-20mA",
      "expected_device_id": "SENSOR010"
    }
  ]
}
```

**æ­¥éª¤ 2: æµ‹è¯•å½“å‰é…ç½®**
```bash
python backend/test_batch_matching.py --config current
```

**æ­¥éª¤ 3: æµ‹è¯•æ–°é…ç½®**
```bash
python backend/test_batch_matching.py --config new
```

**æ­¥éª¤ 4: å¯¹æ¯”ç»“æœ**
```bash
# å¯¹æ¯”å‡†ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°
# é€‰æ‹©æ•ˆæœæ›´å¥½çš„é…ç½®
```



---

## å¸¸è§é—®é¢˜

### é—®é¢˜ 1: ä¸åŒç±»å‹è®¾å¤‡åŒ¹é…åˆ°ç›¸åŒç»“æœ

**ç—‡çŠ¶**: è¾“å…¥"æ¸©åº¦ä¼ æ„Ÿå™¨"å’Œ"å‹åŠ›ä¼ æ„Ÿå™¨"éƒ½åŒ¹é…åˆ°åŒä¸€ä¸ªè®¾å¤‡

**åŸå› **: é€šç”¨å‚æ•°æƒé‡è¿‡é«˜ï¼Œè®¾å¤‡ç±»å‹æƒé‡ä¸è¶³

**è¯Šæ–­**:
```bash
python backend/debug_feature_extraction.py
# æŸ¥çœ‹ç‰¹å¾æƒé‡åˆ†é…
```

**è§£å†³æ–¹æ¡ˆ**:
```json
// 1. é™ä½é€šç”¨å‚æ•°æƒé‡
{
  "feature_weights": {
    "4-20ma": 1.0,  // ä» 3.0 é™ä½åˆ° 1.0
    "0-10v": 1.0    // ä» 3.0 é™ä½åˆ° 1.0
  }
}

// 2. æé«˜è®¾å¤‡ç±»å‹å…³é”®è¯æƒé‡
{
  "feature_weights": {
    "æ¸©åº¦ä¼ æ„Ÿå™¨": 5.0,  // ä» 2.5 æé«˜åˆ° 5.0
    "å‹åŠ›ä¼ æ„Ÿå™¨": 5.0   // ä» 2.5 æé«˜åˆ° 5.0
  }
}

// 3. æé«˜åŒ¹é…é˜ˆå€¼
{
  "global_config": {
    "default_match_threshold": 5.0  // ä» 2.0 æé«˜åˆ° 5.0
  }
}
```

**æ‰¹é‡æ“ä½œ**:
```bash
# æ‰¹é‡é™ä½å‚æ•°æƒé‡
python backend/generate_rules_for_devices.py --all
```

### é—®é¢˜ 2: ç‰¹å¾æå–ä¸æ­£ç¡®

**ç—‡çŠ¶**: æå–çš„ç‰¹å¾åŒ…å«æ— æ„ä¹‰çš„å­—ç¬¦æˆ–ç¼ºå°‘é‡è¦ç‰¹å¾

**åŸå› **: 
- å½’ä¸€åŒ–è§„åˆ™ä¸å½“
- åˆ†éš”ç¬¦é…ç½®é”™è¯¯
- è¿‡æ»¤è§„åˆ™ä¸å®Œå–„

**è¯Šæ–­**:
```bash
python backend/debug_feature_extraction.py
# æŸ¥çœ‹è¯¦ç»†çš„ç‰¹å¾æå–è¿‡ç¨‹
```

**è§£å†³æ–¹æ¡ˆ**:

**æƒ…å†µ 1: ç‰¹å¾è¢«é”™è¯¯æ‹†åˆ†**
```json
// é—®é¢˜: "V5011N1040/U" è¢«æ‹†åˆ†ä¸º "V5011N1040" å’Œ "U"
// åŸå› : "/" è¢«è®¾ç½®ä¸ºåˆ†éš”ç¬¦
// è§£å†³: ä» feature_split_chars ä¸­ç§»é™¤ "/"
{
  "feature_split_chars": ["+", ";", "ï¼›", "ã€", "|", "\\", "\n"]
  // ä¸åŒ…å« "/"
}
```

**æƒ…å†µ 2: ç‰¹å¾åŒ…å«å­—æ®µå**
```json
// é—®é¢˜: æå–çš„ç‰¹å¾åŒ…å« "å‹å·"ã€"é€šå¾„" ç­‰å­—æ®µå
// åŸå› : å…ƒæ•°æ®å…³é”®è¯åˆ—è¡¨ä¸å®Œæ•´
// è§£å†³: åœ¨ TextPreprocessor ä¸­æ·»åŠ æ›´å¤šå…ƒæ•°æ®å…³é”®è¯
{
  "metadata_keywords": [
    "å‹å·", "é€šå¾„", "é˜€ä½“ç±»å‹", "é€‚ç”¨ä»‹è´¨",
    "å“ç‰Œ", "è§„æ ¼", "å‚æ•°", "åç§°", "ç±»å‹"
  ]
}
```

**æƒ…å†µ 3: æ‹¬å·å†…å®¹å¤„ç†ä¸å½“**
```json
// é—®é¢˜: "1/2\"(DN15)" æå–ä¸º "1/2\"(dn15)" è€Œä¸æ˜¯ä¸¤ä¸ªç‹¬ç«‹ç‰¹å¾
// åŸå› : æ‹¬å·å¤„ç†é€»è¾‘æœ‰é—®é¢˜
// è§£å†³: æ£€æŸ¥ extract_features æ–¹æ³•ä¸­çš„æ‹¬å·å¤„ç†ä»£ç 
```

### é—®é¢˜ 3: åŒ¹é…é˜ˆå€¼è¿‡ä½å¯¼è‡´è¯¯åŒ¹é…

**ç—‡çŠ¶**: å¾ˆå¤šä¸ç›¸å…³çš„è®¾å¤‡ä¹Ÿèƒ½åŒ¹é…æˆåŠŸ

**åŸå› **: é»˜è®¤é˜ˆå€¼ 2.0 å¤ªä½ï¼Œåªéœ€ä¸€ä¸ªé€šç”¨å‚æ•°å°±èƒ½åŒ¹é…

**è¯Šæ–­**:
```bash
python backend/diagnose_matching_issue.py
# æŸ¥çœ‹é˜ˆå€¼åˆ†å¸ƒå’ŒåŒ¹é…å¾—åˆ†
```

**è§£å†³æ–¹æ¡ˆ**:
```json
// æé«˜é»˜è®¤é˜ˆå€¼
{
  "global_config": {
    "default_match_threshold": 5.0  // ä» 2.0 æé«˜åˆ° 5.0
  }
}
```

**æ‰¹é‡æ“ä½œ**:
```bash
# é‡æ–°ç”Ÿæˆæ‰€æœ‰è§„åˆ™ï¼ˆä½¿ç”¨æ–°çš„é»˜è®¤é˜ˆå€¼ï¼‰
python backend/generate_rules_for_devices.py --all
```

### é—®é¢˜ 4: å½’ä¸€åŒ–è§„åˆ™å¯¼è‡´ç‰¹å¾é”™è¯¯

**ç—‡çŠ¶**: å½’ä¸€åŒ–åçš„ç‰¹å¾ä¸é¢„æœŸä¸ç¬¦

**åŸå› **: å½’ä¸€åŒ–æ˜ å°„è¡¨é…ç½®ä¸å½“

**è¯Šæ–­**:
```python
# æµ‹è¯•å½’ä¸€åŒ–æ•ˆæœ
from modules.text_preprocessor import TextPreprocessor
import json

with open('data/static_config.json', 'r', encoding='utf-8') as f:
    config = json.load(f)

preprocessor = TextPreprocessor(config)
result = preprocessor.normalize_text("æ¸©åº¦ä¼ æ„Ÿå™¨ï¼Œ0-50â„ƒ")
print(result)  # æŸ¥çœ‹å½’ä¸€åŒ–ç»“æœ
```

**è§£å†³æ–¹æ¡ˆ**:

**æƒ…å†µ 1: é”™è¯¯çš„æ›¿æ¢**
```json
// é—®é¢˜: "â„ƒ" è¢«æ›¿æ¢ä¸º "æ‘„æ°åº¦"ï¼Œå¯¼è‡´ "æ¸©åº¦ä¼ æ„Ÿå™¨" å˜æˆ "æ¸©æ‘„æ°åº¦ä¼ æ„Ÿå™¨"
// åŸå› : å½’ä¸€åŒ–æ˜ å°„ä¸å½“
// è§£å†³: å°† "â„ƒ" æ˜ å°„ä¸ºç©ºå­—ç¬¦ä¸²
{
  "normalization_map": {
    "â„ƒ": "",  // åˆ é™¤è€Œä¸æ˜¯æ›¿æ¢
    "Â°C": ""
  }
}
```

**æƒ…å†µ 2: å¾ªç¯æ›¿æ¢**
```json
// é—®é¢˜: "A" â†’ "B", "B" â†’ "A" å¯¼è‡´æ— é™å¾ªç¯
// è§£å†³: é¿å…å¾ªç¯æ˜ å°„
{
  "normalization_map": {
    "A": "C",  // ä¸è¦æ˜ å°„å› B
    "B": "C"
  }
}
```

### é—®é¢˜ 5: è§„åˆ™ç”Ÿæˆå¤±è´¥

**ç—‡çŠ¶**: è¿è¡Œ `generate_rules_for_devices.py` æ—¶æŠ¥é”™

**åŸå› **: 
- æ•°æ®åº“è¿æ¥å¤±è´¥
- è®¾å¤‡æ•°æ®æ ¼å¼é”™è¯¯
- é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯

**è¯Šæ–­**:
```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
python backend/test_db_connection.py

# æ£€æŸ¥é…ç½®æ–‡ä»¶æ ¼å¼
python -m json.tool data/static_config.json

# æ£€æŸ¥è®¾å¤‡æ•°æ®
python backend/check_db_data.py
```

**è§£å†³æ–¹æ¡ˆ**:

**æƒ…å†µ 1: æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -l data/devices.db

# é‡æ–°åˆå§‹åŒ–æ•°æ®åº“
python backend/init_database.py
```

**æƒ…å†µ 2: é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯**
```bash
# éªŒè¯ JSON æ ¼å¼
python -m json.tool data/static_config.json

# å¦‚æœæœ‰é”™è¯¯ï¼Œä¿®å¤ JSON æ ¼å¼
```



---

## æœ€ä½³å®è·µ

### 1. é…ç½®ç®¡ç†

**ç‰ˆæœ¬æ§åˆ¶**:
```bash
# æ¯æ¬¡ä¿®æ”¹é…ç½®å‰å¤‡ä»½
cp data/static_config.json data/backup/static_config_$(date +%Y%m%d).json

# ä½¿ç”¨ Git ç®¡ç†é…ç½®å˜æ›´
git add data/static_config.json
git commit -m "ä¼˜åŒ–å½’ä¸€åŒ–è§„åˆ™ï¼šåˆ é™¤â„ƒè€Œä¸æ˜¯æ›¿æ¢"
```

**æµ‹è¯•ç¯å¢ƒ**:
```bash
# åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯é…ç½®
cp data/static_config.json data/static_config_test.json
# ä¿®æ”¹æµ‹è¯•é…ç½®
# æµ‹è¯•éªŒè¯
# ç¡®è®¤æ— è¯¯ååº”ç”¨åˆ°ç”Ÿäº§
```

**æ–‡æ¡£è®°å½•**:
```markdown
# é…ç½®å˜æ›´æ—¥å¿—

## 2026-02-26
- ä¿®æ”¹: å°† "â„ƒ" çš„æ˜ å°„ä» "æ‘„æ°åº¦" æ”¹ä¸º ""
- åŸå› : é¿å… "æ¸©åº¦ä¼ æ„Ÿå™¨" è¢«é”™è¯¯å½’ä¸€åŒ–ä¸º "æ¸©æ‘„æ°åº¦ä¼ æ„Ÿå™¨"
- å½±å“: æ‰€æœ‰åŒ…å«æ¸©åº¦å•ä½çš„è®¾å¤‡
- æµ‹è¯•: é€šè¿‡ 100 ä¸ªæµ‹è¯•æ¡ˆä¾‹
```

### 2. è§„åˆ™ä¼˜åŒ–

**æ¸è¿›å¼ä¼˜åŒ–**:
```bash
# 1. å…ˆä¼˜åŒ–å•ä¸ªè§„åˆ™
# 2. æµ‹è¯•éªŒè¯æ•ˆæœ
# 3. æ‰¹é‡åº”ç”¨åˆ°ç›¸ä¼¼è§„åˆ™
# 4. å…¨å±€ä¼˜åŒ–
```

**æ•°æ®é©±åŠ¨**:
```bash
# åŸºäºåŒ¹é…æ—¥å¿—å’Œæµ‹è¯•ç»“æœåšå†³ç­–
# ä¸è¦ç›²ç›®è°ƒæ•´å‚æ•°
```

**ä¿ç•™å¤‡ä»½**:
```bash
# é‡è¦è°ƒæ•´å‰åˆ›å»ºæ•°æ®åº“å¤‡ä»½
cp data/devices.db data/backup/devices_$(date +%Y%m%d).db
```

### 3. æµ‹è¯•éªŒè¯

**å•å…ƒæµ‹è¯•**:
```bash
# æµ‹è¯•ç‰¹å¾æå–
pytest backend/tests/test_text_preprocessor.py -v

# æµ‹è¯•åŒ¹é…å¼•æ“
pytest backend/tests/test_match_engine.py -v
```

**é›†æˆæµ‹è¯•**:
```bash
# æµ‹è¯•å®Œæ•´æµç¨‹
pytest backend/tests/test_integration_e2e.py -v
```

**æ‰‹åŠ¨æµ‹è¯•**:
```bash
# ä½¿ç”¨è°ƒè¯•å·¥å…·æµ‹è¯•
python backend/debug_feature_extraction.py
python backend/verify_rules.py
python backend/test_match_debug.py
```

### 4. æ€§èƒ½ç›‘æ§

**å®šæœŸæ£€æŸ¥æŒ‡æ ‡**:
```bash
# 1. åŒ¹é…å‡†ç¡®ç‡: ç›®æ ‡ â‰¥ 85%
# 2. ç‰¹å¾æå–æ—¶é—´: ç›®æ ‡ < 100ms
# 3. åŒ¹é…æ—¶é—´: ç›®æ ‡ < 500ms
# 4. é”™è¯¯ç‡: ç›®æ ‡ < 5%
```

**æ—¥å¿—åˆ†æ**:
```bash
# æŸ¥çœ‹åŒ¹é…æ—¥å¿—
tail -f backend/logs/app.log | grep "match"

# ç»Ÿè®¡åŒ¹é…æˆåŠŸç‡
grep "åŒ¹é…æˆåŠŸ" backend/logs/app.log | wc -l
grep "åŒ¹é…å¤±è´¥" backend/logs/app.log | wc -l
```

### 5. æŒç»­æ”¹è¿›

**æ”¶é›†åé¦ˆ**:
```bash
# è®°å½•ç”¨æˆ·åé¦ˆçš„é—®é¢˜æ¡ˆä¾‹
# å®šæœŸåˆ†æé«˜é¢‘é—®é¢˜
# åˆ¶å®šä¼˜åŒ–è®¡åˆ’
```

**å®šæœŸè¯„ä¼°**:
```bash
# æ¯æœˆè¯„ä¼°åŒ¹é…å‡†ç¡®ç‡
# æ¯å­£åº¦ä¼˜åŒ–é…ç½®å’Œè§„åˆ™
# æ¯å¹´é‡æ–°è®­ç»ƒæ¨¡å‹ï¼ˆå¦‚æœä½¿ç”¨æœºå™¨å­¦ä¹ ï¼‰
```

**çŸ¥è¯†ç§¯ç´¯**:
```bash
# è®°å½•ä¼˜åŒ–ç»éªŒ
# æ›´æ–°æ–‡æ¡£
# åˆ†äº«æœ€ä½³å®è·µ
```

---

## å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨å‘½ä»¤

```bash
# 1. è°ƒè¯•ç‰¹å¾æå–
python backend/debug_feature_extraction.py

# 2. éªŒè¯è§„åˆ™
python backend/verify_rules.py

# 3. é‡æ–°ç”Ÿæˆæ‰€æœ‰è§„åˆ™
python backend/generate_rules_for_devices.py --all

# 4. è¯Šæ–­åŒ¹é…é—®é¢˜
python backend/diagnose_matching_issue.py

# 5. æµ‹è¯•åŒ¹é…
python backend/test_match_debug.py

# 6. æ£€æŸ¥æ•°æ®åº“æ•°æ®
python backend/check_db_data.py

# 7. è¿è¡Œå•å…ƒæµ‹è¯•
pytest backend/tests/test_text_preprocessor.py -v
pytest backend/tests/test_match_engine.py -v

# 8. è¿è¡Œé›†æˆæµ‹è¯•
pytest backend/tests/test_integration_e2e.py -v
```

### é…ç½®æ–‡ä»¶ä½ç½®

```
data/static_config.json          # ä¸»é…ç½®æ–‡ä»¶
backend/config.py                # ç³»ç»Ÿé…ç½®
backend/modules/text_preprocessor.py   # æ–‡æœ¬é¢„å¤„ç†å™¨
backend/modules/rule_generator.py      # è§„åˆ™ç”Ÿæˆå™¨
backend/modules/match_engine.py        # åŒ¹é…å¼•æ“
```

### å…³é”®å‚æ•°

| å‚æ•° | ä½ç½® | æ¨èå€¼ | è¯´æ˜ |
|------|------|--------|------|
| default_match_threshold | global_config | 5.0 | é»˜è®¤åŒ¹é…é˜ˆå€¼ |
| å“ç‰Œæƒé‡ | RuleGenerator | 3.0 | å“ç‰Œç‰¹å¾æƒé‡ |
| å‹å·æƒé‡ | RuleGenerator | 3.0 | å‹å·ç‰¹å¾æƒé‡ |
| è®¾å¤‡ç±»å‹æƒé‡ | RuleGenerator | 5.0 | è®¾å¤‡ç±»å‹å…³é”®è¯æƒé‡ |
| é€šç”¨å‚æ•°æƒé‡ | RuleGenerator | 1.0 | é€šç”¨å‚æ•°æƒé‡ |

---

## é™„å½•

### A. è®¾å¤‡ç±»å‹å…³é”®è¯åˆ—è¡¨

```python
device_type_keywords = [
    'ä¼ æ„Ÿå™¨', 'æ§åˆ¶å™¨', 'DDC', 'é˜€é—¨', 'æ‰§è¡Œå™¨', 'æ§åˆ¶æŸœ',
    'ç”µæº', 'ç»§ç”µå™¨', 'ç½‘å…³', 'æ¨¡å—', 'æ¢æµ‹å™¨', 'å¼€å…³',
    'å˜é€å™¨', 'æ¸©æ§å™¨', 'é£é˜€', 'æ°´é˜€', 'ç”µåŠ¨é˜€', 'è°ƒèŠ‚é˜€',
    'å‹åŠ›ä¼ æ„Ÿå™¨', 'æ¸©åº¦ä¼ æ„Ÿå™¨', 'æ¹¿åº¦ä¼ æ„Ÿå™¨', 'CO2ä¼ æ„Ÿå™¨',
    'æµé‡è®¡', 'å‹å·®å¼€å…³', 'æ¶²ä½å¼€å…³', 'é£æœº', 'æ°´æ³µ',
    'é‡‡é›†å™¨', 'æœåŠ¡å™¨', 'ç”µè„‘', 'è½¯ä»¶', 'ç³»ç»Ÿ'
]
```

### B. å“ç‰Œå…³é”®è¯åˆ—è¡¨

```python
brand_keywords = [
    'éœå°¼éŸ¦å°”', 'è¥¿é—¨å­', 'æ±Ÿæ£®è‡ªæ§', 'æ–½è€å¾·', 'æ˜çº¬',
    'æ¬§å§†é¾™', 'ABB', 'ä¸¹ä½›æ–¯', 'è´å°”è«', 'Honeywell',
    'Siemens', 'Johnson', 'Schneider', 'OMRON', 'Danfoss',
    'Belimo', 'Delta', 'å°è¾¾', 'æ­£æ³°', 'å¾·åŠ›è¥¿'
]
```

### C. å…ƒæ•°æ®å…³é”®è¯åˆ—è¡¨

```python
metadata_keywords = [
    'å‹å·', 'é€šå¾„', 'é˜€ä½“ç±»å‹', 'é€‚ç”¨ä»‹è´¨', 'å“ç‰Œ', 
    'è§„æ ¼', 'å‚æ•°', 'åç§°', 'ç±»å‹', 'å°ºå¯¸', 'æè´¨',
    'åŠŸç‡', 'ç”µå‹', 'ç”µæµ', 'é¢‘ç‡', 'æ¸©åº¦', 'å‹åŠ›',
    'æµé‡', 'æ¹¿åº¦', 'æµ“åº¦', 'èŒƒå›´', 'ç²¾åº¦', 'è¾“å‡º',
    'è¾“å…¥', 'ä¿¡å·', 'æ¥å£', 'å®‰è£…', 'é˜²æŠ¤', 'ç­‰çº§'
]
```

---

## è”ç³»æ”¯æŒ

å¦‚é‡åˆ°æ— æ³•è§£å†³çš„é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„"å¸¸è§é—®é¢˜"ç« èŠ‚
2. è¿è¡Œè¯Šæ–­å·¥å…·åˆ†æé—®é¢˜
3. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—è·å–è¯¦ç»†ä¿¡æ¯
4. è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿ

**ç›¸å…³æ–‡æ¡£**:
- [MAINTENANCE.md](../MAINTENANCE.md) - ç³»ç»Ÿç»´æŠ¤æŒ‡å—
- [MATCHING_OPTIMIZATION_SUMMARY.md](../MATCHING_OPTIMIZATION_SUMMARY.md) - åŒ¹é…ä¼˜åŒ–æ€»ç»“
- [README.md](../README.md) - é¡¹ç›®æ¦‚è¿°

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-02-26  
**æœ€åæ›´æ–°**: 2026-02-26  
**ç»´æŠ¤è€…**: DDC ç³»ç»Ÿå¼€å‘å›¢é˜Ÿ  
**é€‚ç”¨äº**: Kiro AI åŠ©æ‰‹å’Œç³»ç»Ÿç»´æŠ¤äººå‘˜

