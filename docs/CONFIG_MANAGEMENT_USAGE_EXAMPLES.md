# 配置管理使用示例

## 目录
1. [调整特征权重提高匹配准确性](#1-调整特征权重提高匹配准确性)
2. [添加元数据关键词优化特征提取](#2-添加元数据关键词优化特征提取)
3. [调整设备行识别阈值](#3-调整设备行识别阈值)
4. [配置导出和导入](#4-配置导出和导入)
5. [版本回滚](#5-版本回滚)

---

## 1. 调整特征权重提高匹配准确性

### 场景描述
系统在匹配时经常将不同类型的设备混淆，需要提高设备类型特征的权重。

### 操作步骤

1. **进入配置管理页面**
   - 访问 http://localhost:3000/config
   - 或从主页点击"配置管理"卡片

2. **选择特征权重配置**
   - 点击左侧菜单"⚖️ 特征权重"

3. **调整权重值**
   - 将"设备类型权重"从 5.0 调整到 7.0
   - 将"参数权重"从 1.0 调整到 0.5
   
   ```
   品牌权重: 3.0 (保持不变)
   型号权重: 3.0 (保持不变)
   设备类型权重: 7.0 (提高)
   参数权重: 0.5 (降低)
   ```

4. **保存配置**
   - 点击右上角"保存"按钮
   - 输入备注："提高设备类型权重以减少混淆"
   - 确认保存

5. **重新生成规则**
   - 点击"重新生成规则"按钮
   - 确认操作
   - 等待规则生成完成

6. **验证效果**
   - 上传测试Excel文件
   - 检查匹配结果是否改善

### 预期效果
- 设备类型匹配更准确
- 减少不同类型设备的混淆
- 通用参数对匹配的干扰降低

---

## 2. 添加元数据关键词优化特征提取

### 场景描述
Excel文件中的设备描述包含很多字段名称（如"产品型号："、"制造商："），这些字段名被错误地提取为特征，影响匹配准确性。

### 操作步骤

1. **识别问题**
   - 上传Excel文件后发现匹配不准确
   - 检查提取的特征，发现包含"产品型号"、"制造商"等字段名

2. **进入高级配置**
   - 访问配置管理页面
   - 点击左侧菜单"🔧 高级配置"

3. **添加元数据关键词**
   - 在输入框中输入"产品型号"，按回车
   - 继续添加"制造商"、"产品名称"、"技术参数"等
   
   ```
   新增关键词：
   - 产品型号
   - 制造商
   - 产品名称
   - 技术参数
   - 产品规格
   ```

4. **保存配置**
   - 点击"保存"按钮
   - 输入备注："添加常见字段名称到元数据关键词"

5. **测试效果**
   - 重新上传Excel文件
   - 使用实时预览功能测试
   - 输入："产品型号：QAA2061"
   - 查看提取的特征是否只包含"qaa2061"

### 预期效果
- 字段名称不再被提取为特征
- 只提取实际的设备信息
- 匹配准确性提高

### 示例对比

**添加前**:
```
输入: "产品型号：QAA2061 制造商：霍尼韦尔"
提取特征: ["产品型号", "qaa2061", "制造商", "霍尼韦尔"]
```

**添加后**:
```
输入: "产品型号：QAA2061 制造商：霍尼韦尔"
提取特征: ["qaa2061", "霍尼韦尔"]
```

---

## 3. 调整设备行识别阈值

### 场景描述
系统在解析Excel时，将一些非设备行（如小计、合计）误识别为设备行，需要提高识别阈值。

### 操作步骤

1. **分析问题**
   - 上传Excel文件
   - 查看设备行识别结果
   - 发现一些得分在40-50之间的非设备行被识别为设备行

2. **进入设备行识别配置**
   - 访问配置管理页面
   - 点击左侧菜单"🎯 设备行识别"

3. **调整概率阈值**
   - 将"高概率阈值"从 50 调整到 60
   - 将"中概率阈值"从 30 调整到 40
   
   ```
   高概率阈值: 60 (提高)
   中概率阈值: 40 (提高)
   ```

4. **保存配置**
   - 点击"保存"按钮
   - 输入备注："提高阈值以减少误识别"

5. **验证效果**
   - 重新上传Excel文件
   - 检查设备行识别结果
   - 确认非设备行不再被误识别

### 预期效果
- 减少非设备行的误识别
- 提高设备行识别的准确性
- 可能需要手动确认更多的中概率行

---

## 4. 配置导出和导入

### 场景A: 备份当前配置

1. **导出配置**
   - 进入配置管理页面
   - 点击"导出"按钮
   - 保存文件：`config_export_1709020800000.json`

2. **保存到安全位置**
   - 将导出的文件保存到备份目录
   - 建议命名：`config_backup_2026-02-27_优化后.json`

### 场景B: 在多个环境间同步配置

1. **从开发环境导出**
   - 在开发环境配置管理页面
   - 点击"导出"按钮
   - 保存文件

2. **导入到生产环境**
   - 在生产环境配置管理页面
   - 点击"导入"按钮
   - 选择导出的配置文件
   - 输入备注："从开发环境同步配置"
   - 确认导入

3. **验证配置**
   - 检查各配置项是否正确
   - 测试匹配功能

### 场景C: 恢复到之前的配置

1. **导入备份文件**
   - 点击"导入"按钮
   - 选择之前备份的配置文件
   - 输入备注："恢复到优化前的配置"
   - 确认导入

2. **重新生成规则**
   - 点击"重新生成规则"按钮
   - 等待完成

---

## 5. 版本回滚

### 场景描述
修改配置后发现匹配效果变差，需要回滚到之前的版本。

### 操作步骤

1. **打开版本历史**
   - 进入配置管理页面
   - 点击左下角"📜 版本历史"按钮

2. **查看历史版本**
   ```
   版本 5    2026-02-27 14:30:00
   提高设备类型权重以减少混淆
   [ 回滚 ]
   
   版本 4    2026-02-27 10:15:00
   添加常见字段名称到元数据关键词
   [ 回滚 ]
   
   版本 3    2026-02-26 16:45:00
   优化特征权重配置
   [ 回滚 ]
   ```

3. **选择要回滚的版本**
   - 点击版本3的"回滚"按钮
   - 确认回滚操作

4. **验证回滚结果**
   - 检查配置是否恢复到版本3
   - 测试匹配功能

5. **重新生成规则**
   - 点击"重新生成规则"按钮
   - 应用回滚后的配置

### 注意事项
- 回滚操作会创建一个新版本
- 原有版本不会被删除
- 可以随时回滚到任何历史版本

---

## 6. 综合优化流程

### 场景描述
新部署系统，需要根据实际数据进行全面配置优化。

### 第一阶段：基础配置

1. **配置品牌关键词**
   - 添加常用品牌
   - 包括中英文名称

2. **配置设备类型**
   - 添加常见设备类型
   - 包括各种传感器、控制器、阀门等

3. **配置同义词映射**
   - 添加常见同义词
   - 如："温度传感器" → "温传感器"

### 第二阶段：特征提取优化

1. **添加元数据关键词**
   - 分析Excel文件中的字段名
   - 添加到元数据关键词列表

2. **调整最小特征长度**
   - 根据实际数据调整
   - 避免过短的无意义特征

### 第三阶段：权重调优

1. **初始测试**
   - 使用默认权重测试
   - 记录匹配准确率

2. **调整权重**
   - 根据测试结果调整
   - 逐步优化各类特征权重

3. **重新生成规则**
   - 应用新权重
   - 再次测试

### 第四阶段：设备行识别优化

1. **分析识别结果**
   - 检查误识别的行
   - 统计得分分布

2. **调整阈值**
   - 根据分析结果调整
   - 平衡准确性和召回率

### 第五阶段：持续优化

1. **定期备份配置**
   - 每次优化后导出配置
   - 保存到备份目录

2. **记录优化效果**
   - 记录每次调整的效果
   - 建立优化日志

3. **版本管理**
   - 使用有意义的备注
   - 便于追踪配置变更

---

## 最佳实践

### 1. 配置修改前
- ✅ 导出当前配置作为备份
- ✅ 记录当前的匹配准确率
- ✅ 准备测试数据

### 2. 配置修改时
- ✅ 一次只修改一个配置项
- ✅ 使用实时预览功能测试
- ✅ 输入有意义的备注信息

### 3. 配置修改后
- ✅ 重新生成规则
- ✅ 使用测试数据验证
- ✅ 对比修改前后的效果
- ✅ 如果效果不佳，及时回滚

### 4. 配置管理
- ✅ 定期备份配置文件
- ✅ 建立配置变更日志
- ✅ 在不同环境间同步配置
- ✅ 保留重要版本的配置

---

## 常见问题

### Q1: 修改配置后需要重启系统吗？
A: 不需要。保存配置后，点击"重新生成规则"按钮即可应用新配置。

### Q2: 如何知道哪个权重值最合适？
A: 建议从默认值开始，根据实际匹配效果逐步调整。可以使用实时预览功能测试不同的权重值。

### Q3: 元数据关键词会影响已有的设备数据吗？
A: 不会。元数据关键词只影响新上传的Excel文件的特征提取，不会修改已有的设备数据。

### Q4: 版本历史会保留多久？
A: 所有版本都会永久保留，除非手动删除数据库。

### Q5: 可以同时修改多个配置项吗？
A: 可以，但建议一次只修改一个配置项，便于追踪效果和问题定位。

---

## 相关文档

- [配置管理高级功能详细说明](./CONFIG_MANAGEMENT_ADVANCED_FEATURES.md)
- [配置管理UI界面说明](./CONFIG_MANAGEMENT_UI_SCREENSHOTS.md)
- [配置管理用户指南](./CONFIG_MANAGEMENT_USER_GUIDE.md)
