# RuleEditor 组件测试指南

## 测试环境准备

### 1. 启动后端服务

```bash
cd backend
python app.py
```

后端服务应该运行在 `http://localhost:5000`

### 2. 启动前端开发服务器

```bash
cd frontend
npm run dev
```

前端应用应该运行在 `http://localhost:5173`

## 测试步骤

### 测试 1: 访问规则编辑页面

1. 打开浏览器访问 `http://localhost:5173/rule-management`
2. 在规则列表中找到任意一条规则
3. 点击"编辑"按钮
4. 应该跳转到规则编辑页面 `/rule-editor/{rule_id}`

**预期结果:**
- 页面正常加载，显示规则编辑器组件
- 设备基本信息正确显示
- 匹配阈值显示正确
- 特征列表按权重从高到低排序
- 权重分布图表正常渲染

### 测试 2: 编辑匹配阈值

1. 在规则编辑页面，找到"匹配阈值"部分
2. 修改阈值数值（例如从 2.0 改为 5.0）
3. 观察阈值提示信息的变化

**预期结果:**
- 阈值 < 3: 显示红色警告
- 阈值 3-5: 显示黄色警告
- 阈值 ≥ 5: 显示绿色成功提示

### 测试 3: 编辑特征权重

1. 在特征列表中，修改某个特征的权重值
2. 观察列表是否自动重新排序
3. 观察权重分布图表是否更新

**预期结果:**
- 特征列表自动按权重从高到低重新排序
- 图表实时更新，显示新的权重分布
- 柱状图颜色根据权重值变化（红色≥5，橙色3-5，蓝色<3）

### 测试 4: 添加新特征

1. 点击"添加特征"按钮
2. 在对话框中输入：
   - 特征名称: "测试特征"
   - 权重: 2.5
   - 类型: "参数"
3. 点击"确定"

**预期结果:**
- 新特征添加到列表中
- 列表自动重新排序
- 图表更新显示新特征
- 显示成功消息

### 测试 5: 删除特征

1. 在特征列表中，点击某个特征的"删除"按钮
2. 在确认对话框中点击"确定"

**预期结果:**
- 显示确认对话框
- 确认后特征从列表中移除
- 图表更新
- 显示成功消息

### 测试 6: 批量调整权重

1. 点击"批量调整"按钮
2. 在对话框中选择：
   - 特征类型: "参数"
   - 新权重值: 1.0
3. 点击"确定"

**预期结果:**
- 所有"参数"类型的特征权重更新为 1.0
- 列表自动重新排序
- 图表更新
- 显示成功消息，提示调整了多少个特征

### 测试 7: 重置为默认

1. 修改一些权重值和阈值
2. 点击"重置为默认"按钮
3. 在确认对话框中点击"确定"

**预期结果:**
- 显示确认对话框
- 确认后所有修改恢复到初始状态
- 图表恢复到初始状态
- 显示成功消息

### 测试 8: 保存修改

1. 修改阈值和一些权重值
2. 点击"保存修改"按钮

**预期结果:**
- 显示加载状态
- 保存成功后显示成功消息
- 1秒后自动返回规则列表页面
- 在规则列表中可以看到更新后的阈值

### 测试 9: 取消编辑

1. 修改一些配置
2. 点击"取消"按钮

**预期结果:**
- 直接返回规则列表页面
- 修改未保存

### 测试 10: 响应式布局

1. 调整浏览器窗口大小
2. 观察图表是否自动调整

**预期结果:**
- 图表自动适应窗口大小
- 布局保持合理

## 错误处理测试

### 测试 11: 添加重复特征

1. 点击"添加特征"
2. 输入一个已存在的特征名称
3. 点击"确定"

**预期结果:**
- 显示警告消息："该特征已存在"
- 特征未添加到列表

### 测试 12: 添加空特征

1. 点击"添加特征"
2. 特征名称留空
3. 点击"确定"

**预期结果:**
- 显示警告消息："请输入特征名称"
- 特征未添加到列表

### 测试 13: 网络错误处理

1. 停止后端服务
2. 尝试保存修改

**预期结果:**
- 显示错误消息："规则保存失败，请稍后重试"
- 保存按钮恢复正常状态

### 测试 14: 无效规则ID

1. 在浏览器地址栏输入一个不存在的规则ID
   例如: `http://localhost:5173/rule-editor/INVALID_RULE_ID`

**预期结果:**
- 显示错误消息："获取规则详情失败"
- 页面显示加载失败状态

## 性能测试

### 测试 15: 大量特征处理

1. 找到一个包含大量特征（>50个）的规则
2. 编辑该规则
3. 修改权重值
4. 观察响应速度

**预期结果:**
- 页面加载流畅
- 权重修改后排序和图表更新及时
- 无明显卡顿

## 浏览器兼容性测试

在以下浏览器中重复上述测试：
- Chrome (最新版本)
- Firefox (最新版本)
- Edge (最新版本)
- Safari (最新版本，如果可用)

**预期结果:**
- 所有功能在各浏览器中正常工作
- 样式显示一致

## 验收标准

所有测试通过后，确认以下功能正常：

- ✅ 设备基本信息正确显示
- ✅ 特征列表按权重排序
- ✅ 权重值可以实时编辑
- ✅ 匹配阈值可以编辑
- ✅ 可以添加新特征
- ✅ 可以删除特征
- ✅ 批量调整权重功能正常
- ✅ 重置为默认功能正常
- ✅ 权重分布图表正确显示
- ✅ 保存功能正常
- ✅ 取消功能正常
- ✅ 错误处理正确
- ✅ 响应式布局正常

## 已知问题

（记录测试过程中发现的问题）

## 测试结果

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 测试 1: 访问规则编辑页面 | ⬜ 待测试 | |
| 测试 2: 编辑匹配阈值 | ⬜ 待测试 | |
| 测试 3: 编辑特征权重 | ⬜ 待测试 | |
| 测试 4: 添加新特征 | ⬜ 待测试 | |
| 测试 5: 删除特征 | ⬜ 待测试 | |
| 测试 6: 批量调整权重 | ⬜ 待测试 | |
| 测试 7: 重置为默认 | ⬜ 待测试 | |
| 测试 8: 保存修改 | ⬜ 待测试 | |
| 测试 9: 取消编辑 | ⬜ 待测试 | |
| 测试 10: 响应式布局 | ⬜ 待测试 | |
| 测试 11: 添加重复特征 | ⬜ 待测试 | |
| 测试 12: 添加空特征 | ⬜ 待测试 | |
| 测试 13: 网络错误处理 | ⬜ 待测试 | |
| 测试 14: 无效规则ID | ⬜ 待测试 | |
| 测试 15: 大量特征处理 | ⬜ 待测试 | |

## 测试人员签名

测试人员: _______________
测试日期: _______________
测试结果: ⬜ 通过 ⬜ 不通过
